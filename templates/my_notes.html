{% extends "base.html" %}

{% block title %}Jegyzeteim - Bibliaolvasási Terv{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col">
        <h2><i class="bi bi-journal-text"></i> Jegyzeteim</h2>
        <p class="text-muted">{{ username }} kiemelései és jegyzetei időrendben visszafelé</p>
    </div>
</div>

<!-- Statisztikák és szűrés -->
<div class="row mb-4">
    <div class="col-md-8">
        <div class="btn-group" role="group">
            <a href="{{ url_for('bible.my_notes', view='all') }}" 
               class="btn {% if view_type == 'all' %}btn-primary{% else %}btn-outline-primary{% endif %}">
                <i class="bi bi-collection"></i> Összes ({{ total_comments + total_highlights }})
            </a>
            <a href="{{ url_for('bible.my_notes', view='comments') }}" 
               class="btn {% if view_type == 'comments' %}btn-primary{% else %}btn-outline-primary{% endif %}">
                <i class="bi bi-chat-left-text"></i> Jegyzetek ({{ total_comments }})
            </a>
            <a href="{{ url_for('bible.my_notes', view='highlights') }}" 
               class="btn {% if view_type == 'highlights' %}btn-primary{% else %}btn-outline-primary{% endif %}">
                <i class="bi bi-highlighter"></i> Kiemelések ({{ total_highlights }})
            </a>
        </div>
    </div>
</div>

<!-- Jegyzetek listája -->
<div class="row">
    <div class="col-lg-10">
        {% if notes %}
            {% for note in notes %}
            <div class="card mb-3 note-card">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start mb-2">
                        <div>
                            {% if note.type == 'comment' %}
                                <span class="badge bg-info me-2">
                                    <i class="bi bi-chat-left-text"></i> Jegyzet
                                </span>
                            {% else %}
                                <span class="badge bg-warning text-dark me-2">
                                    <i class="bi bi-highlighter"></i> Kiemelés
                                </span>
                            {% endif %}
                            <a href="{{ url_for('bible.daily', date_str=note.date) }}" class="text-decoration-none">
                                <i class="bi bi-calendar-event"></i> {{ note.date }}
                            </a>
                        </div>
                        <small class="text-muted">
                            <i class="bi bi-clock"></i>
                            {{ note.created_at[:16].replace('T', ' ') if 'T' in note.created_at else note.created_at[:16] }}
                        </small>
                    </div>
                    
                    {% if note.type == 'comment' %}
                        <div class="note-content">
                            {% if note.verse_ref %}
                            <div class="mb-2">
                                <span class="badge bg-secondary">
                                    <i class="bi bi-bookmark"></i> {{ note.verse_ref }}
                                </span>
                            </div>
                            {% endif %}
                            <p class="mb-0">{{ note.text }}</p>
                        </div>
                    {% else %}
                        <div class="highlight-content">
                            {% if note.verse_ref %}
                            <div class="mb-2">
                                <span class="badge bg-secondary">
                                    <i class="bi bi-bookmark"></i> {{ note.verse_ref }}
                                </span>
                            </div>
                            {% endif %}
                            <span class="highlight-text" style="background-color: {{ note.color or '#fff3cd' }}; padding: 2px 6px; border-radius: 3px;">
                                „{{ note.text }}"
                            </span>
                        </div>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="alert alert-info">
                <i class="bi bi-info-circle"></i>
                {% if view_type == 'all' %}
                    Még nincsenek jegyzeteid vagy kiemeléseid. Látogass el a napi olvasmányokhoz, és kezdj el jegyzetelni!
                {% elif view_type == 'comments' %}
                    Még nincsenek jegyzeteid. A napi olvasmányoknál tudsz hozzáfűzni saját gondolatokat.
                {% else %}
                    Még nincsenek kiemeléseid. Jelölj ki szöveget a Bibliában, majd válaszd ki a kívánt színt!
                {% endif %}
            </div>
        {% endif %}
    </div>
</div>

<style>
    .note-card {
        border-left: 4px solid var(--color-primary);
        transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .note-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .note-content {
        font-size: 1.05rem;
        line-height: 1.6;
        color: var(--text-primary);
    }
    
    .highlight-content {
        font-style: italic;
        font-size: 1.05rem;
        line-height: 1.6;
    }
    
    .highlight-text {
        display: inline;
    }
</style>
{% endblock %}
